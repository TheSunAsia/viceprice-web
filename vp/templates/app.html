<html>
	<head>
		<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
		<link rel="stylesheet" type="text/css" href="../static/css/component.css" />
		<link href='https://api.mapbox.com/mapbox.js/v2.3.0/mapbox.css' rel='stylesheet' />
		<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Montserrat">
		<!-- JS -->
		<script src='https://code.jquery.com/jquery-2.2.1.min.js'></script>
		<script src='https://api.mapbox.com/mapbox.js/v2.3.0/mapbox.js'></script>
		<script src='../static/js/cluster.js'></script>
		<style>
			body {
				margin: 0;
				padding: 0;
			}
			#map {
				position: absolute;
				top: 0;
				bottom: 0;
				width: 100%;
			}
			.pin {
				width: 35px;
				height: 35px;
				border-radius: 50% 50% 50% 10%;
				border: solid white 3.5px;
				background: #89849b;
				position: absolute;
				transform: rotateY(30deg);
				left: 50%;
				top: 50%;
				margin: -20px 0 0 -20px;
			}
		</style>
	</head>
	<body>
		<div id='map'></div>
		<script>
			L.mapbox.accessToken = 'pk.eyJ1Ijoic2FsbWFuYWVlIiwiYSI6ImNpa2ZsdXdweTAwMXl0d20yMWVlY3g4a24ifQ._0c3U-A8Lv6C7Sm3ceeiHw';

			var geoJsonData = [];
			var southWest = L.latLng(38.820993, -76.875833), northEast = L.latLng(39.004460, -77.158084), bounds = L.latLngBounds(southWest, northEast);

			var map = L.mapbox.map('map');

			L.mapbox.styleLayer('mapbox://styles/mapbox/dark-v8').addTo(map);
			map.setView([38.907557, -77.009014], 13).setMaxBounds(bounds);

			var clusterGroup = new L.MarkerClusterGroup({
				polygonOptions : {
					fillColor : 'white',
					color : 'white',
					weight : 2,
					opacity : 1,
					fillOpacity : 0.3
				}
			});
			//end of cluster
			$.get("../fetch/", function(data) {
				geoJsonData = data.json;
				var goeJsonlayer = L.geoJson(geoJsonData, {
					onEachFeature : function(feature, layer) {
						layer.setIcon(L.divIcon(feature.properties.icon));
						var content = '<div class="tooltip"><h1>' + feature.properties.name + '<\/h1>' + '<p>' + feature.properties.phone + '<br \/>' + feature.properties.website + '<\/p> <\/div>';
						layer.bindPopup(content);
					}
				});
				clusterGroup.addLayer(goeJsonlayer);
				map.addLayer(clusterGroup);

			});
		</script>
	</body>
</html>