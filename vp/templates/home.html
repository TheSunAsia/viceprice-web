<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8 />
<title> VicePrice </title>
<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
	<!-- css -->
	<link rel="stylesheet" type="text/css" href="../static/css/component.css" />
	<link href='https://api.mapbox.com/mapbox.js/v2.3.0/mapbox.css' rel='stylesheet' />
	<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Montserrat">
	<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
	<!-- JS -->
	<script src='https://code.jquery.com/jquery-2.2.1.min.js'></script>
	<script src='https://api.mapbox.com/mapbox.js/v2.3.0/mapbox.js'></script>
	<script src='../static/js/cluster.js'></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  	<script src="//code.jquery.com/jquery-1.10.2.js"></script>
  	<script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
		<style>
			body {
				font-family: 'Montserrat';
				margin: 0;
				padding: 0;
			}
			.map {
				position: absolute;
				top: 0;
				bottom: 0;
				width: 100%;
			}
			.pin {
			  width: 25px;
			  height: 25px;
			  border-radius: 50% 50% 50% 10%;
			  border:solid white 3.5px;
			  background: #89849b;
			  position: absolute;
			  transform: rotateY(30deg);
			  left: 50%;
			  top: 50%;
			  margin: -20px 0 0 -20px;
			  }

		</style>
	</head>
	<body>
		<div class='grid'>
			<div id='map' class='map' style='position:fixed;'></div>

			{% include '_filters.html' %}

			{% include '_venue_details.html' %}

		</div>
		<script src='../static/js/dcn.js'></script>
		<script>
			$(".tiles").hover(function() {
                    $(this).addClass('hoverBg');
                },function() {
                    $(this).removeClass('hoverBg');
                });

   			$("input:checkbox").click(function() {
                    var ischecked= $(this).is(':checked');
                    if(!ischecked)
                       $("label[for='"+$(this).attr('id')+"']").removeClass('hoverBg');
                });

   			function outputUpdate(num) {
    		if(num==1)
			document.querySelector('#day_output').value = "Sat";
			else if (num==2)
			document.querySelector('#day_output').value= "Sun";
			else if (num==3)
			document.querySelector('#day_output').value= "Mon";
			else if (num==4)
			document.querySelector('#day_output').value= "Tues";
			else if (num==5)
			document.querySelector('#day_output').value= "Wed";
			else if (num==6)
			document.querySelector('#day_output').value= "Thurs";
			else if(num==7)
			document.querySelector('#day_output').value= "Fri";
			else if (num==8)
			document.querySelector('#time_output').value= "8:00 AM";
			else if (num==9)
			document.querySelector('#time_output').value= "8:30 AM";
			else if (num==10)
			document.querySelector('#time_output').value= "9:00 AM";
			else if (num==11)
			document.querySelector('#time_output').value= "9:30 AM";
			else if (num==12)
			document.querySelector('#time_output').value= "10:00 AM";
			else if(num==13)
			document.querySelector('#time_output').value= "10:30 AM";
			else if(num==14)
			document.querySelector('#time_output').value= "11:00 AM";
			else if (num==15)
			document.querySelector('#time_output').value= "11:30 AM";
			else if (num==16)
			document.querySelector('#time_output').value= "12:00 PM";
			else if (num==17)
			document.querySelector('#time_output').value= "12:30 PM";
			else if (num==18)
			document.querySelector('#time_output').value= "1:00 PM";
			else if (num==19)
			document.querySelector('#time_output').value= "1:30 PM";
			else if(num==20)
			document.querySelector('#time_output').value= "2:00 PM";
			else if(num==21)
			document.querySelector('#time_output').value= "2:30 PM";
			else if (num==22)
			document.querySelector('#time_output').value= "3:00 PM";
			else if (num==23)
			document.querySelector('#time_output').value= "3:30 PM";
			else if (num==24)
			document.querySelector('#time_output').value= "4:00 PM";
			else if (num==25)
			document.querySelector('#time_output').value= "4:30 PM";
			else if (num==26)
			document.querySelector('#time_output').value= "5:00 PM";
			else if(num==27)
			document.querySelector('#time_output').value= "5:30 PM";
			else if (num==28)
			document.querySelector('#time_output').value= "6:00 PM";
			else if (num==29)
			document.querySelector('#time_output').value= "6:30 PM";
			else if(num==30)
			document.querySelector('#time_output').value= "7:00 PM";
			else if (num==31)
			document.querySelector('#time_output').value= "7:30 PM";
			else if(num==32)
			document.querySelector('#time_output').value= "8:00 PM";
			else if (num==33)
			document.querySelector('#time_output').value= "8:30 PM";
			else if (num==34)
			document.querySelector('#time_output').value= "9:00 PM";
			else if(num==35)
			document.querySelector('#time_output').value= "9:30 PM";
			else if(num==36)
			document.querySelector('#time_output').value= "10:00 PM";
			else if (num==37)
			document.querySelector('#time_output').value= "10:30 PM";
			else if (num==38)
			document.querySelector('#time_output').value= "11:00 PM";
		}
			/*****MapBox*****/
			L.mapbox.accessToken = 'pk.eyJ1Ijoic2FsbWFuYWVlIiwiYSI6ImNpa2ZsdXdweTAwMXl0d20yMWVlY3g4a24ifQ._0c3U-A8Lv6C7Sm3ceeiHw';

			var southWest = L.latLng(38.820993, -76.875833), northEast = L.latLng(39.004460, -77.158084),
				bounds = L.latLngBounds(southWest, northEast);
			var map = L.mapbox.map('map');
			L.mapbox.styleLayer('mapbox://styles/salmanaee/cikoa5qxo00gf9vm0s5cut4aa').addTo(map);
			map.setView([38.907557, -77.028130]);
			map.setMaxBounds(bounds);
			map.setZoom(13);
			/*************************/
			var clusterGroup = new L.MarkerClusterGroup({polygonOptions: {
            fillColor: 'white',
            color: 'white',
            weight: 2,
            opacity: 1,
            fillOpacity: 0.3
	        }
	     	});//end of cluster
			$.get("../fetch/", function(data) {
					geoJsonData = data.json;
					var goeJsonlayer = L.geoJson(geoJsonData, {
						onEachFeature : function(feature, layer) {
							console.log(feature);
							layer.setIcon(L.divIcon(feature.properties.icon));
							var content = '<div class="tooltip"><h1>' + feature.properties.name + '<\/h1>' + '<p>' + feature.properties.phone + '<br \/>' + feature.properties.website + '<\/p> <\/div>';
							layer.bindPopup(content);
						}
					});
					//map.addLayer(goeJsonlayer);
 					//map.addLayer(clusterGroup);

				});

				/***DC Neighborhoods***/
				var dcnLayer = L.geoJson(dcn,  {
      			style: getStyle,
      			onEachFeature: onEachFeature
  				}).addTo(map);

				var label,div,currentZoom;
  				function getStyle(feature) {
      			return {
          		weight: 2,
          		opacity: 0.5,
          		color: '#c8a45e',
          		fillOpacity: 0.8,
          		fillColor: 'rgb(35, 40, 43)',
      			};
  				}

  				function onEachFeature(feature, layer) {
      			layer.on({
              		mousemove: mousemove,
              		mouseout: mouseout,
            		click: click
            		});

            	label = L.marker(layer.getBounds().getCenter(), {
            	icon: L.divIcon({
            		className: 'label',
    				html: getHTML(feature.id,feature.properties.name),
            		iconSize: [100, 35]
             		})}).addTo(map);
          		};
            	/*map.on('zoomend', function() {
				  currentZoom = map.getZoom();
				  $('.map_labels').css('font-size', currentZoom/1.5);
				});*/
				function click(e) {
				map.fitBounds(e.target.getBounds());
				}

				function mousemove(e) {
			    var layer = e.target;
					layer.setStyle({
				          weight: 3,
				          opacity: 0.5,
				          fillColor:'#c8a45e',
				          fillOpacity: 0.8
				    });
				  if (!L.Browser.ie && !L.Browser.opera) {
          			layer.bringToFront();
      				}
  				}
  				function mouseout(e) {
			      dcnLayer.resetStyle(e.target);
  				}

				function getHTML(e,d) {
				 return e == 1 ? "<div class='map_labels' style='font-size:18px;margin-top:30%;'>" + d +"</div>" : //north DC
		                e == 2  ?"<div class='map_labels' style='font-size:18px;margin-left:30%;'>" + d +"</div>" :  //west dc
		                e == 3  ? "<div class='map_labels' style='font-size:16px;'>" + d +"</div> " :  //Friendship Heights
		                e == 4  ? "<div class='map_labels' style='font-size:14px;'>" + d +"</div>" :  //Adams Morgan
		                e == 5  ?"<div class='map_labels' style='font-size:18px;margin-right:30%;'>" + d +"</div>" :  //East dc
		                e == 6  ? "<div class='map_labels' style='font-size:16px;'>" + d +"</div>" :  //shaw
		                e == 7  ? "<div class='map_labels' style='font-size:16px;'>" + d +"</div>" :  //Capitol Hill
		                e == 8 ? "<div class='map_labels' style='font-size:16px;margin-top:15%;'>" + d +"</div>" :  //downtown
		                e == 9 ? "<div class='map_labels' style='font-size:14px;'>" + d +"</div>" :  //Columbia Heights
		                e == 10 ? "<div class='map_labels' style='font-size:14px;width:50px;margin-left:30%;margin-top:10%;'>" + d +"</div>" :  //Dupont Circle
		                e == 11 ? "<div class='map_labels' style='font-size:16px;'>" + d +"</div>" :  //foggy bottom
		                e == 12 ? "<div class='map_labels' style='font-size:16px;'>" + d +"</div>" :  //georgetown
		                e == 13 ? "<div class='map_labels' style='font-size:14px;width:50px;margin-left:25%;'>" + d +"</div>" :  //Logan Circle
		                e == 14 ? "<div class='map_labels' style='font-size:14px;margin-top:10%;'>" + d +"</div>" :  //u street
		                e == 15 ? "<div class='map_labels' style='font-size:14px;margin-rigth:50%;'>" + d +"</div>" : //Waterfront
		                e == 16 ? "<div class='map_labels' style='font-size:18px;text-align:left;'>" + d +"</div>" : //South east
		                "<div class='map_labels' style='font-size:14px;margin-top:10%;'>" + d +"</div>"; //h street
						}
		</script>
	</body>
</html>
